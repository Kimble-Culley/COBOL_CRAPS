IDENTIFICATION DIVISION.
PROGRAM-ID. DISPLAY-TOP-SCORES.

ENVIRONMENT DIVISION.
INPUT-OUTPUT SECTION.
FILE-CONTROL.
    SELECT SCORE-FILE ASSIGN TO "player.dat"
        ORGANIZATION IS LINE SEQUENTIAL
        ACCESS MODE IS SEQUENTIAL
        FILE STATUS IS FILE-STATUS.

DATA DIVISION.
FILE SECTION.
FD SCORE-FILE.
01 SCORE-RECORD-IN.
    02 SCR-NAME    PIC X(20).
    02 SCR-SALARY  PIC 9(5).

WORKING-STORAGE SECTION.
01 FILE-STATUS  PIC X(2).
01 USER-INPUT   PIC X(1).

01 SCR-INDEX    PIC 9(2) VALUE 1.  *> Loop index

01 SCORE-TABLE.
   02 SCORE OCCURS 10 TIMES.
      03 SCR-TBL-NAME   PIC X(20).
      03 SCR-TBL-SALARY PIC 9(5).

SCREEN SECTION.
01 SCORE-SCREEN BACKGROUND-COLOR 2 FOREGROUND-COLOR 7 HIGHLIGHT.
    02 BLANK SCREEN.
    02 LINE 1  COL 10 VALUE "TOP 10 HIGH SCORES".
    02 LINE 2  COL 10 VALUE "-------------------".

    *> Display each score manually
    02 LINE  3 COL 10 USING SCR-TBL-NAME(1).
    02 LINE  3 COL 35 USING SCR-TBL-SALARY(1).
    02 LINE  4 COL 10 USING SCR-TBL-NAME(2).
    02 LINE  4 COL 35 USING SCR-TBL-SALARY(2).
    02 LINE  5 COL 10 USING SCR-TBL-NAME(3).
    02 LINE  5 COL 35 USING SCR-TBL-SALARY(3).
    02 LINE  6 COL 10 USING SCR-TBL-NAME(4).
    02 LINE  6 COL 35 USING SCR-TBL-SALARY(4).
    02 LINE  7 COL 10 USING SCR-TBL-NAME(5).
    02 LINE  7 COL 35 USING SCR-TBL-SALARY(5).
    02 LINE  8 COL 10 USING SCR-TBL-NAME(6).
    02 LINE  8 COL 35 USING SCR-TBL-SALARY(6).
    02 LINE  9 COL 10 USING SCR-TBL-NAME(7).
    02 LINE  9 COL 35 USING SCR-TBL-SALARY(7).
    02 LINE 10 COL 10 USING SCR-TBL-NAME(8).
    02 LINE 10 COL 35 USING SCR-TBL-SALARY(8).
    02 LINE 11 COL 10 USING SCR-TBL-NAME(9).
    02 LINE 11 COL 35 USING SCR-TBL-SALARY(9).
    02 LINE 12 COL 10 USING SCR-TBL-NAME(10).
    02 LINE 12 COL 35 USING SCR-TBL-SALARY(10).

    *> User input prompt
    02 LINE 14 COL 10 VALUE "Press ENTER to exit...".
    02 LINE 15 COL 10 USING USER-INPUT.

PROCEDURE DIVISION.

    *> Open file and read scores
    OPEN INPUT SCORE-FILE.
    IF FILE-STATUS NOT = "00"
        DISPLAY "Error opening file, status: " FILE-STATUS
        STOP RUN
    END-IF.

    PERFORM READ-SCORES.
    CLOSE SCORE-FILE.

    *> Display the high scores screen
    DISPLAY SCORE-SCREEN.

    *> Wait for user input before exiting
    ACCEPT USER-INPUT.
    GOBACK.

READ-SCORES.
    MOVE 1 TO SCR-INDEX.  *> Initialize index

    PERFORM UNTIL SCR-INDEX > 10 OR FILE-STATUS = "10"
        READ SCORE-FILE INTO SCORE-RECORD-IN
            AT END MOVE "10" TO FILE-STATUS
        END-READ
        IF FILE-STATUS NOT = "10"
            MOVE SCR-NAME  TO SCR-TBL-NAME(SCR-INDEX)
            MOVE SCR-SALARY TO SCR-TBL-SALARY(SCR-INDEX)
            ADD 1 TO SCR-INDEX
        END-IF
    END-PERFORM.
